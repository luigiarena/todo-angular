<div class="add-todo">
      <div class="form-header">
        <h2>‚ûï Aggiungi Nuova Attivit√†</h2>
        <button 
          class="toggle-btn"
          (click)="toggleForm()"
          [attr.aria-expanded]="showForm()"
        >
          {{ showForm() ? '‚úï' : '+' }}
        </button>
      </div>

      @if (showForm()) {
        <form [formGroup]="todoForm" (ngSubmit)="onSubmit()" class="todo-form">
          <div class="form-row">
            <div class="form-group flex-2">
              <label for="title">Titolo *</label>
              <input
                type="text"
                id="title"
                formControlName="title"
                placeholder="Cosa devi fare?"
                [class.error]="isFieldInvalid('title')"
              >
              @if (isFieldInvalid('title')) {
                <div class="error-message">
                  @if (todoForm.get('title')?.errors?.['required']) {
                    Il titolo √® obbligatorio
                  }
                  @if (todoForm.get('title')?.errors?.['minlength']) {
                    Il titolo deve avere almeno 3 caratteri
                  }
                  @if (todoForm.get('title')?.errors?.['maxlength']) {
                    Il titolo non pu√≤ superare i 100 caratteri
                  }
                </div>
              }
            </div>

            <div class="form-group flex-1">
              <label for="priority">Priorit√†</label>
              <select id="priority" formControlName="priority">
                <option value="low">üü¢ Bassa</option>
                <option value="medium">üü° Media</option>
                <option value="high">üî¥ Alta</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="description">
              Descrizione 
              <span class="optional">(opzionale)</span>
            </label>
            <textarea
              id="description"
              formControlName="description"
              placeholder="Aggiungi dettagli..."
              rows="3"
              [class.error]="isFieldInvalid('description')"
            ></textarea>
            @if (isFieldInvalid('description')) {
              <div class="error-message">
                La descrizione non pu√≤ superare i 500 caratteri
              </div>
            }
          </div>

          <div class="form-actions">
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="todoForm.invalid || isSubmitting()"
            >
              @if (isSubmitting()) {
                ‚è≥ Aggiungendo...
              } @else {
                ‚úÖ Aggiungi Attivit√†
              }
            </button>
            
            <button 
              type="button" 
              class="btn btn-secondary"
              (click)="resetForm()"
            >
              üîÑ Reset
            </button>
          </div>
        </form>
      }
    </div>